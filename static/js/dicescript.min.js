function BetViewModel(){var t=this;t._maxBetLimit=ko.observable(0),t.maxBetLimit=ko.computed(function(){return t._maxBetLimit()}),t.betAmountEditing=ko.observable(!1),t.payoutEditing=ko.observable(!1),t.winChanceEditing=ko.observable(!1),t.profit=ko.observable(0),t._betAmount=ko.observable(0),t.betAmount=ko.computed({read:function(){return t.betAmountEditing()?t.betAmount():parseFloat(t._betAmount()).toFixed(8)},write:function(e){parseFloat(e)>parseFloat(clientModel.clientBalance())&&(e=clientModel.clientBalance());var o=parseFloat(e),a=o*t._payout()-o;a>t._maxBetLimit()?(a=t._maxBetLimit(),o=a/(t._payout()-1)):1e-8>a&&(a=0),t._betAmount(o),t.profit(a.toFixed(8)),t._betAmount.valueHasMutated()}}).extend({notify:"always"}),t._payout=ko.observable(initialPayout),t.payout=ko.computed({read:function(){return t.payoutEditing()?t.payout():parseFloat(t._payout()).toFixed(4)},write:function(e){payout=parseFloat(e),payout>100?payout=100:1.0001>payout&&(payout=1.0001);var o=t._betAmount(),a=o*payout-o;a>t._maxBetLimit()?(a=t._maxBetLimit(),o=a/(t._payout()-1)):1e-8>a&&(a=0),t.betAmount(o.toFixed(8)),t.profit(a.toFixed(8)),t._payout(payout.toFixed(4)),t._payout.valueHasMutated()}}).extend({notify:"always"}),t._winChance=ko.computed({read:function(){return((100-houseEdge)/t._payout()).toFixed(2)},write:function(e){var o=(100-houseEdge)/e,a=t._betAmount(),n=a*o-a;n>t._maxBetLimit()?(n=t._maxBetLimit(),a=n/(t._payout()-1)):1e-8>n&&(n=0),t.betAmount(a.toFixed(8)),t.profit(n.toFixed(8)),t._payout(o.toFixed(4))}}),t.winChance=ko.computed({read:function(){return t.winChanceEditing()?t.winChance():parseFloat(t._winChance()).toFixed(2)},write:function(e){parseFloat(e)>97.99?e=97.99:parseFloat(e)<.98&&(e=.98),t._winChance(e)}}).extend({notify:"always"}),t.underAmount=ko.computed(function(){return((100-houseEdge)/t._payout()).toFixed(2)}),t.overAmount=ko.computed(function(){return(100-t.underAmount()).toFixed(2)}),t.underText=ko.computed(function(){return"Roll Under "+t.underAmount()}),t.overText=ko.computed(function(){return"Roll Over "+t.overAmount()}),minBetAmount=function(){t.betAmount(1e-8)},maxBetAmount=function(){try{t.betAmount(clientModel.clientBalance())}catch(e){t.betAmount(0)}},doubleBetAmount=function(){var e=t.betAmount(),o=2*e;try{t.betAmount(o>clientModel.clientBalance()?clientModel.clientBalance():o)}catch(a){t.betAmount(0)}},halfBetAmount=function(){var e=t.betAmount();t.betAmount(e/2)}}function BetStatsModel(){var t=this;t.totalWagered=ko.observable(0),t.totalBets=ko.observable(0)}function getCookie(t){var e=document.cookie.match("\\b"+t+"=([^;]*)\\b");return e?e[1]:void 0}function requestServerVars(t){var e=new SockJS("http://"+window.location.host+"/status");e.onopen=function(){void 0!=t&&e.send(t)},e.onmessage=function(o){if(data=$.parseJSON(o.data),updateType=data.type,"seed"==updateType&&void 0!=t)seedModel.serverSeedHash(data.serverSeedHash);else if("stats"==updateType){betStatsModel.totalWagered(data.totalWagered),betStatsModel.totalBets(data.totalBets),betViewModel._maxBetLimit(parseFloat(data.maxBetLimit));for(var a=data.betHistory.length-1;a>=0;a--)$("#betHistory > tbody").prepend("win"==data.betHistory[a][8]?"<tr><td>"+data.betHistory[a][0]+"</td><td>"+data.betHistory[a][1]+"</td><td>"+data.betHistory[a][2]+"</td><td>"+data.betHistory[a][3].toFixed(8)+"</td><td>"+data.betHistory[a][4].toFixed(4)+"</td><td>"+data.betHistory[a][5]+"</td><td><strong>"+data.betHistory[a][6]+"</strong></td><td class='profit'>+"+data.betHistory[a][7].toFixed(8)+"</td></tr>":"<tr><td>"+data.betHistory[a][0]+"</td><td>"+data.betHistory[a][1]+"</td><td>"+data.betHistory[a][2]+"</td><td>"+data.betHistory[a][3].toFixed(8)+"</td><td>"+data.betHistory[a][4].toFixed(4)+"</td><td>"+data.betHistory[a][5]+"</td><td><strong>"+data.betHistory[a][6]+"</strong></td><td class='loss'>"+data.betHistory[a][7].toFixed(8)+"</td></tr>");for(;$("#betHistory > tbody > tr").length>30;)$("#betHistory tr:last").remove()}else"client"==updateType&&void 0!=t&&(clientModel.clientBalance($.parseJSON(o.data).clientBalance),setTimeout(function(){e.send(t)},3e4))},e.onerror=function(){}}var initialWinChance=49.5,initialPayout=2,_clientSeed=uuid.v4().replace(/-/g,"");betViewModel=new BetViewModel,ko.applyBindings(betViewModel,document.getElementById("betForm")),$(document).ready(function(){$("#loginForm").submit(function(t){args={username:JSON.stringify($("#loginusername").val()),password:JSON.stringify($("#loginpassword").val())},args._xsrf=getCookie("_xsrf"),$.ajax({url:"/login",type:"post",data:args,success:function(){window.location.reload()},error:function(t){$("#invalidLogin").text(t.statusText),$("#invalidLogin").fadeIn()}}),t.preventDefault()}),$("#signupForm").submit(function(t){args={username:JSON.stringify($("#signupusername").val()),password:JSON.stringify($("#signuppassword").val()),email:JSON.stringify($("#signupemail").val())},args._xsrf=getCookie("_xsrf"),$.ajax({url:"/signup",type:"post",data:args,success:function(){$("#signupStatus").text("Account successfully created. Logging you in now."),$("#signupStatus").fadeIn(),setTimeout(function(){window.location.reload()},1e3)},error:function(t){$("#signupStatus").text(t.statusText),$("#signupStatus").fadeIn()}}),t.preventDefault()}),$("#rollUnder").click(function(t){t.preventDefault(),$("#rollUnder").attr("disabled",!0),$("#rollOver").attr("disabled",!0),$("#gameType").val("under"),$("#betForm").trigger("submit")}),$("#rollOver").click(function(t){t.preventDefault(),$("#rollUnder").attr("disabled",!0),$("#rollOver").attr("disabled",!0),$("#gameType").val("over"),$("#betForm").trigger("submit")}),$("#betForm").submit(function(t){args={betAmount:JSON.stringify($("#betFormBetAmount").val()),winChance:JSON.stringify($("#betFormWinChance").val()),clientSeed:JSON.stringify(_clientSeed),gameType:JSON.stringify($("#gameType").val())},args._xsrf=getCookie("_xsrf"),$.ajax({url:"/roll",type:"post",data:args,success:function(t){$("#betResultStatus").fadeOut(400,function(){"win"==t.result?$(this).removeClass("warning info").addClass("success"):$(this).removeClass("success info").addClass("info"),clientModel.clientBalance(t.bal),$(this).text(t.message).fadeIn(400)})},error:function(t){$("#betResultStatus").fadeOut(400,function(){$("#betResultStatus").removeClass("success info").addClass("warning"),$(this).text(t.statusText).fadeIn(400)})},complete:function(){$("#rollUnder").attr("disabled",!1),$("#rollOver").attr("disabled",!1)}}),t.preventDefault()})});var betStatsModel=new BetStatsModel;ko.applyBindings(betStatsModel,document.getElementById("siteStats"));